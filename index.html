<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>1.头部导航布局</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/index.css">
</head>
<body style="height: 1000px">
<!--包裹器   整个页面的容器-->
<div class="wrap">
    <header class="header">
        <!--头部第一行-->
        <div class="top">
            <div class="container">
                <!--登录-->
                <div class="login">
                    <p>尚品汇欢迎您！</p>
                    <p>
                        <span>请</span>
                        <a href="###">登录</a>
                        <a href="###" class="register">免费注册</a>
                    </p>
                </div>
                <!--头部导航-->
                <div class="headerNav">
                    <a href="###">我的订单</a>
                    <a href="###">我的购物车</a>
                    <a href="###">我的尚品汇</a>
                    <a href="###">尚品汇会员</a>
                    <a href="###">企业采购</a>
                    <a href="###">关注尚品汇</a>
                    <a href="###">合作招商</a>
                    <a href="###">商家后台</a>
                </div>
            </div>

        </div>
        <!--头部第二行-->
        <div class="bottom">
            <h1 class="logoArea">
                <a href="###">
                    <img src="img/Logo.png" alt="尚品汇">
                </a>
            </h1>
            <div class="searchArea">
                <form action="">
                    <input type="text">
                    <button>搜索</button>
                </form>
            </div>
        </div>
    </header>
    <!--商品导航分类-->
    <div class="typeNav">
        <div class="container">
            <h2 class="all">全部商品分类</h2>
            <nav>
                <a href="###">服装城</a>
                <a href="###">美妆馆</a>
                <a href="###">尚品汇超市</a>
                <a href="###">全球购</a>
                <a href="###">闪购</a>
                <a href="###">团购</a>
                <a href="###">有趣</a>
                <a href="###">秒杀</a>
            </nav>
        </div>
    </div>
    <!--商品主要内容区域-->
    <section class="con">
        <!--路径导航-->
        <div class="conPoin">
            <a href="###">手机、数码、通讯</a>
            <a href="###">手机</a>
            <a href="###">Apple苹果</a>
            <a >iphone 6S系类</a>
        </div>
        <!--主要内容区域-->
        <div class="mainCon">
            <!--左侧放大镜-->
            <div class="previewWrap">
                <!--放大镜效果-->
                <div class="preview">
                    <!--小图-->
                    <div class="zoom">
                        <img src="img/s1.png" alt="">
                    </div>
                    <!--大图-->
                </div>
                <!--缩略图效果-->
                <div class="specScroll">
                    <a class="prev">&lt;</a>
                    <div class="itemCon">
                        <ul class="list">
                            <li><img src="img/s1.png" alt=""></li>
                            <li><img src="img/s2.png" alt=""></li>
                            <li><img src="img/s3.png" alt=""></li>
                            <li><img src="img/s1.png" alt=""></li>
                            <li><img src="img/s2.png" alt=""></li>
                            <li><img src="img/s3.png" alt=""></li>
                            <li><img src="img/s1.png" alt=""></li>
                            <li><img src="img/s2.png" alt=""></li>
                        </ul>
                    </div>
                    <a class="next">&gt;</a>
                </div>
            </div>
            <!--右侧商品信息-->
            <div class="infoWrap">
                <div class="info1">
                    <h3 class="infoName">Apple iPhone 6s（A1700）64G玫瑰金色 移动通信电信4G手机</h3>
                    <p class="news">推荐选择下方[移动优惠购],手机套餐齐搞定,不用换号,每月还有话费返</p>
                    <div class="priceArea">
                        <div class="priceArea1">
                            <div class="title">价&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;格</div>
                            <div class="price">
                                <i>￥</i>
                                <em>5299</em>
                                <span>降价通知</span>
                            </div>
                            <div class="remark">
                                <i>累计评价</i>
                                <span>1234</span>
                            </div>
                        </div>
                        <div class="priceArea2">
                            <div class="title">促&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;销</div>
                            <div class="fixWidth">
                                <i>加价购</i>
                                <span> 满999.00另加20.00元，或满1999.00另加30.00元，或满2999.00另加40.00元，即可在购物车换购热销商品</span>
                            </div>
                        </div>
                    </div>
                    <div class="support">
                        <div>
                            <div class="title">支&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;持</div>
                            <div class="fixWidth">以旧换新，闲置手机回收 4G套餐超值抢 礼品购</div>
                        </div>
                        <div>
                            <div class="title">配&nbsp;送&nbsp;至</div>
                            <div class="fixWidth">广东省 深圳市 宝安区</div>
                        </div>
                    </div>
                </div>
                <div class="choose">
                    <div class="chooseArea">
                        <div class="choosed">

                        </div>
                    </div>
                    <div class="carWrap">
                        <div class="controls">
                            <input type="text" value="1">
                            <a href="###" class="plus">+</a>
                            <a href="###" class="mins">-</a>
                        </div>
                        <div class="addBtn">
                            <a href="###">加入购物车</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
<script type="text/javascript">
    //页面加载完成的回调
    //  window.onload = function () {
    //
    //  }
    //  文档准备就绪
    //   DOMContentLoaded 等待节点加载完成之后执行
    //    DOMContentLoaded 是dom2级事件  所以需要使用addEventListener绑定监听
    window.addEventListener('DOMContentLoaded',function () {
//      定义放大镜图片id
        var magnifierImgId = 0;
//        每一个功能都会单独放在一个函数中运行
//        1.放大镜效果
        magnifier();
        function magnifier() {
            var imgSrc = [
                { b: "./img/b1.png", s: "./img/s1.png" },
                { b: "./img/b2.png", s: "./img/s2.png" },
                { b: "./img/b3.png", s: "./img/s3.png" },
                { b: "./img/b1.png", s: "./img/s1.png" },
                { b: "./img/b2.png", s: "./img/s2.png" },
                { b: "./img/b3.png", s: "./img/s3.png" },
                { b: "./img/b1.png", s: "./img/s1.png" },
                { b: "./img/b2.png", s: "./img/s2.png" }
            ];
//            修改放大镜的小图src为动态的数据
            var smallImg = document.querySelector('.wrap .con .mainCon .previewWrap .preview .zoom>img');
            smallImg.src = imgSrc[magnifierImgId].s;
            //          放大镜外层容器
            var preview = document.querySelector('.wrap .con .mainCon .previewWrap .preview');
//            小图容器
            var smallBox = document.querySelector('.wrap .con .mainCon .previewWrap .preview .zoom')
//          初始化蒙版
            var mask = null;
//          初始化大图容器
            var bigBox = null;
//          初始化大图
            var bigImg = null;

//            绑定鼠标移入移出事件
            preview.onmouseenter = function () {
//              当鼠标移入元素时  创建蒙版(大图容器 大图)   没有蒙版的时候 才会创建 如果存在则不创建
                if(!mask){
//                  创建蒙版
                    mask = document.createElement('div');
//                   给蒙版一个class   并且添加样式
                    mask.className = 'mask';
//                   把蒙版插入到小图容器当中
                    smallBox.appendChild(mask);
//                   创建大图 和大图容器
                    bigBox = document.createElement('div');
                    bigBox.className = 'bigBox';
//                  创建大图  放入大图容器当中
                    bigImg = new Image();
                    bigImg.src = imgSrc[magnifierImgId].b;
                    bigBox.appendChild(bigImg);

                    preview.appendChild(bigBox);
                }
//               鼠标移动
                smallBox.onmousemove = function (event) {
//                  当鼠标移动的时候  蒙版的位置是  鼠标的坐标 - 蒙版的一半 - 父级距离屏幕边缘的位置
                    var maskPosition = {
                        left:event.clientX - mask.offsetWidth / 2 -smallBox.getBoundingClientRect().left,
                        top:event.clientY - mask.offsetHeight / 2 - smallBox.getBoundingClientRect().top
                    };
//                   边界判断  小于最小值等于最小值  大于最大值等于最大值
                    if(maskPosition.left < 0){
                        maskPosition.left = 0;
                    }else if(maskPosition.left > smallBox.clientWidth - mask.offsetWidth){
                        maskPosition.left = smallBox.clientWidth - mask.offsetWidth;
                    }
                    if(maskPosition.top < 0 ){
                        maskPosition.top = 0;
                    }else if(maskPosition.top > smallBox.clientHeight - mask.offsetHeight){
                        maskPosition.top = smallBox.clientHeight - mask.offsetHeight;
                    }

//                  对蒙版的位置进行操作
                    mask.style.left = maskPosition.left + 'px';
                    mask.style.top = maskPosition.top + 'px';

//                   计算比例： （蒙版总共可以移动的距离 / 大图能够移动的距离）
                    var scale = (smallBox.clientWidth - mask.offsetWidth) / ( bigImg.offsetWidth-bigBox.clientWidth)
//                    console.log(scale);
//                    计算大图位置
                    var bigPosition = {
                        left:maskPosition.left / scale,
                        top:maskPosition.top / scale
                    }
//                   给大图修正位置
                    bigImg.style.marginLeft = -bigPosition.left + 'px';
                    bigImg.style.marginTop = -bigPosition.top + 'px';
                };
//              当鼠标离开时 放大镜效果结束  清除蒙版  移除事件
                preview.onmouseleave = function () {
//                移除节点
                    smallBox.removeChild(mask);
                    preview.removeChild(bigBox);
//                初始化蒙版元素
                    mask = null;
                    bigBox = null;
                    bigImg = null;
//                解绑事件
                    smallBox.onmousemove = null;
                    preview.onmouseleave = null;
                }


            }


        }
//        获取元素非行间样式
//        第一个参数要读取的元素 第二个参数要读取的样式名称
        function getStyle(obj,attr) {
            if(obj.currentStyle){
                return obj.currentStyle[attr];
            }else{
                return document.defaultView.getComputedStyle(obj,null)[attr];
            }
        }
//      2.缩略图
        thumbnail();
        function thumbnail() {
//            图片移动的容器
            var list = document.querySelector('.wrap .con .mainCon .previewWrap .specScroll .itemCon .list ');
//            图片集合
            var items = document.querySelectorAll('.wrap .con .mainCon .previewWrap .specScroll .itemCon .list > li')
//        左右两个按钮
            var prev = document.querySelector('.wrap .con .mainCon .previewWrap .specScroll .prev');
            var next = document.querySelector('.wrap .con .mainCon .previewWrap .specScroll .next');

//           定义图片显示张数
            var showImg = 5;
//            定义初始化已经走过的距离
            var tempLeft = 0;
//            获取li的marginRight
            var itemRight = parseInt(getStyle(items[0],'marginRight'));
//           计算一共可以移动的距离   (总张数 - 显示张数) * (图片的宽 + marginRight)
            var countLeft = (items.length - showImg) * (items[0].offsetWidth + itemRight);
//           每次移动的图片数量
            var moveNum = 2;
//           计算每次移动的长度  (一个元素的宽度 + marginRight)* 每次移动的图片数量
            var moveLeft = (items[0].offsetWidth + itemRight) * moveNum;
//            添加过渡
            list.style.transition = '0.2s linear';
//            给两个按钮绑定单击事件
            next.onclick = function () {
//                如果已经走过的距离 小于 总共可以走的距离 才能移动
                if(tempLeft < countLeft){
//              tempLeft = 600         countLeft = 700    走一次是200
//               剩余的距离 = countLeft - tempLeft
//                  如果剩余的距离大于每次可以移动的距离  则走该移动的距离(moveLeft)
                    if(countLeft - tempLeft > moveLeft){
                        tempLeft += moveLeft;
                    }else{
//                        如果剩余的距离小于每次可以移动的距离  则走剩下的所有  100
                        tempLeft += (countLeft - tempLeft);
                    }
                    list.style.left = -tempLeft + 'px';
                }
            };
            prev.onclick = function () {
//             如果可移动距离还大于0  说明可以向左移动
                if(tempLeft >0){
//                  如果可以走的距离 大于每次移动的距离  则走该走的长度 否则直接为0
                    if(tempLeft > moveLeft){
                        tempLeft -= moveLeft;
                    }else {
                        tempLeft = 0;
                    }
                    list.style.left = -tempLeft + 'px';
                }
            }
        }
//      3.缩略图点击
        thumbnailClick();
        function thumbnailClick() {
//          获取所有图片
            var itemImgs = document.querySelectorAll('.wrap .con .mainCon .previewWrap .specScroll .itemCon .list > li>img')
//           获取小图
            var smallImg = document.querySelector('.wrap .con .mainCon .previewWrap .preview .zoom>img');
            for (var i = 0; i < itemImgs.length; i++) {
//                itemImgs[i].index = i;
                itemImgs[i].onclick = function () {
                    for (var i = 0; i < itemImgs.length; i++) {
                        if(itemImgs[i] == this){
                            magnifierImgId = i;
                            //                         修改小图路径
                            smallImg.src = this.src;
                        }
                    }

                }
            }
        }
//     4.商品筛选详情   动态数据加载
        screening();
        function screening() {
            var crumbData = [
                {
                    'title':'选择颜色',
                    'data':['黄金色','亮银银色','大黑色']
                },
                {
                    'title':'内存容量',
                    'data':['160G','640G','1280G','2560G']
                },
                {
                    'title':'选择版本',
                    'data':['公开版','移动版']
                },
                {
                    'title':'购买方式',
                    'data':['官方标配','优惠移动版','电信优惠版']
                }
            ];
//         获取父容器
            var chooseAreaNode = document.querySelector('.wrap .con .mainCon .infoWrap .choose .chooseArea')
            crumbData.forEach(function (item) {
//            每次遍历进来 先创建一个dl
                var dlNode = document.createElement('dl');
//              每一个dl都只有一个dt 所以可以直接在这里创建
                var dtNode = document.createElement('dt');
//              给dt赋值
                dtNode.innerHTML = item.title;
//              把dt放到dl当中
                dlNode.appendChild(dtNode);
//              console.log(dlNode);
//              通过遍历每一个item的data 动态生成相应的dd
                item.data.forEach(function (item) {
//                 这个forEach当中的item 对应的是data里边的每一个元素值
//                生成dd
                    var ddNode = document.createElement('dd');
//                 给dd插入内容
                    ddNode.innerHTML = item;
//                 把dd放入到dl当中
                    dlNode.appendChild(ddNode);
                });
                chooseAreaNode.appendChild(dlNode);
            });

//          以下是点击选择筛选内容的交互代码

//            获取所有的dl
            var dlList = chooseAreaNode.getElementsByTagName('dl');
//           定义一个数组容器，数组中保存筛选的条件，需要的时候，按照顺序保存或者获取里边的内容
//            var arr = [];
//            for (var i = 0; i < crumbData.length; i++) {
//                arr[i] = 0;
//            }
//            console.log(arr)
            var arr = new Array(crumbData.length);
//            fill es6数组方法    用传入的值 填充整个数组当中的每一个元素
            arr.fill(0);
//            遍历所有的dl标签，然后给当前dl标签中的dd绑定事件
            for (var i = 0; i < dlList.length; i++) {
//                给dl添加下标
                dlList[i].index = i;
                (function () {
//                获取当前dl标签中对应的dd
                    var ddList = dlList[i].getElementsByTagName('dd');
                    for (var j = 0; j < ddList.length; j++) {
                        ddList[j].onclick = function () {
//                     先清除所有dd的颜色
                            for (var i = 0; i < ddList.length; i++) {
                                ddList[i].style.color = '#666';
                            }
//                      再给当前的添加红色
                            this.style.color = 'red';
//                          只要用户点击操作了 就要对数组进行修改
                            arr[this.parentNode.index] = this.innerHTML;
                            console.log(arr);
//                          获取mark元素的容器

                            var choosedNode = document.querySelector('.wrap .con .mainCon .infoWrap .choose .chooseArea .choosed')
//                            在每一次创建之前 清空整个父容器
                            choosedNode.innerHTML = '';
//                            遍历数组  创建相应的结构
                            arr.forEach(function (item) {
//                               检测数组  当数组当前元素值不为0的时候 创建mark
                                if(item){
//                                  创建mark
                                    var markNode = document.createElement('mark');
//                                  把数组内容放到mark当中去
                                    markNode.innerHTML = item;
//                                  创建mark里边的a标签
                                    var aNode = document.createElement('a');
//                                   给a标签添加X
                                    aNode.innerHTML = 'X';
//                                  把a标签放入到mark当中
                                    markNode.appendChild(aNode);
//                                  把mark放入到choosedNode当中
                                    choosedNode.appendChild(markNode);
                                }

                            })

                        }
                    }
                })();



            }
        }

    })
</script>
</body>
</html>